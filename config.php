<?php

include_once "common.php";

define("NAME", "WebCmd");
define("VERSION", "0.0.4");

// Files

define("FILE_OUT", "./etc/out");
define("FILE_HELP", "./etc/help");

// Text

define("TEXT_EXIT", "You can only close windows called by script in Gecko/WebKit.");

define("TEXT_HEADER", "Terrasoft WebCmd [Version " . VERSION . "] [" . vs() . "]".
        			  "<br />Copyright &copy; " . date("Y") . " Terrasoft Co.  All rights reserved.");
		
define("TEXT_LOADING", "Loading output...");

// Custom commands' help messages. Having these definitions in an array makes it
// possible to recreate it automatically in the JS.

$arrCmds["bold"] = "Turns text emboldening on or off. \
					<br /> \
					<br />BOLD [ON | OFF] \
					<br /> \
					<br />The on/off switch is optional.  Without it, toggling will occur. \
					<br />";

$arrCmds["font"] = "Changes the terminal's font face. \
					<br /> \
					<br />FONT [name] \
					<br /> \
					<br />" . nbsp(2) . "name" . nbsp(10) . "Name of the font to which to change. \
					<br />";

$arrCmds["italic"] = "Turns text italicizing on or off. \
					<br /> \
					<br />ITALIC [ON | OFF] \
					<br /> \
					<br />The on/off switch is optional.  Without it, toggling will occur. \
					<br />";

$arrCmds["nircmd"] = addslashes("Available NirCmd commands:<br /><br /><table border='0' cellpadding='' width=1000><tbody><tr><td>Open the door of J: CD-ROM drive</td><td nowrap=''><span class='commandline'>nircmd.exe cdrom open j: </span></td></tr><tr><td>Close the door of Y: CD-ROM drive</td><td class='commandline' nowrap=''>nircmd.exe cdrom close y: </td></tr><tr><td>Speaks the text currently in the clipboard (For Windows XP and Vista).</td><td class='commandline' nowrap=''>speak text ~\$clipboard\$ </td></tr><tr><td>Increase the system volume by 2000 units (out of 65535)</td><td class='commandline' nowrap=''>nircmd.exe changesysvolume 2000</td></tr><tr><td>Decrease the system volume by 5000 units (out of 65535)</td><td class='commandline' nowrap=''>nircmd.exe changesysvolume -5000</td></tr><tr><td>Set the volume to the highest value</td><td class='commandline' nowrap=''>nircmd.exe setsysvolume 65535</td></tr><tr><td>Mute the system volume</td><td class='commandline' nowrap=''>nircmd.exe mutesysvolume 1</td></tr><tr><td>Unmute the system volume</td><td class='commandline' nowrap=''>nircmd.exe mutesysvolume 0</td></tr><tr><td>Switch the system volume between the mute and normal state.</td><td class='commandline' nowrap=''>nircmd.exe mutesysvolume 2</td></tr><tr><td>Create a shortcut on your desktop that switch the system volume between the mute and normal state.</td><td class='commandline'>nircmd.exe cmdshortcut  '~\$folder.desktop\$' 'Switch Volume' mutesysvolume 2</td></tr><tr><td>Turn off the monitor</td><td class='commandline' nowrap=''>nircmd.exe monitor off</td></tr><tr><td>Start the default screen saver</td><td class='commandline' nowrap=''>nircmd.exe screensaver  </td></tr><tr><td>Put your computer in 'standby' mode</td><td class='commandline' nowrap=''>nircmd.exe standby</td></tr><tr><td>log off the current user</td><td class='commandline' nowrap=''>nircmd.exe exitwin logoff</td></tr><tr><td>Ask if you want to reboot, and if you answer 'Yes', reboot the computer.</td><td class='commandline' nowrap=''>nircmd.exe qboxcom 'Do you want to reboot ?' 'question' exitwin reboot</td></tr><tr><td>Turn off your computer</td><td class='commandline' nowrap=''>nircmd.exe exitwin poweroff </td></tr><tr><td>Turn off all computers specified in computers.txt !</td><td class='commandline' nowrap=''>multiremote copy 'c:\temp\computers.txt' exitwin poweroff force </td></tr><tr><td>Dial to 'My Internet' connection </td><td class='commandline' nowrap=''>nircmd.exe rasdial 'My Internet'</td></tr><tr><td>Disconnect the 'My Internet' connection </td><td class='commandline' nowrap=''>nircmd.exe rashangup 'My Internet'</td></tr><tr><td>Make your Internet Explorer windows 75% transparent ! (192 / 256)</td><td class='commandline' nowrap=''>nircmd.exe win trans ititle 'internet explorer' 192</td></tr><tr><td>Minimize all your Internet Explorer windows </td><td class='commandline' nowrap=''>nircmd.exe win min class 'IEFrame' </td></tr><tr><td>Close all your Internet Explorer windows </td><td class='commandline' nowrap=''>nircmd.exe win close class 'IEFrame' </td></tr><tr><td>Close all your Explorer windows (My Computer, folders, and so on)</td><td class='commandline' nowrap=''>nircmd.exe win close class 'CabinetWClass'</td></tr><tr><td>Hide all your Internet Explorer windows </td><td class='commandline' nowrap=''>nircmd.exe win hide class 'IEFrame' </td></tr><tr><td>Show all your Internet Explorer windows (after you made them hidden with previous example)</td><td class='commandline' nowrap=''>nircmd.exe win show class 'IEFrame' </td></tr><tr><td>Center all top-level windows</td><td class='commandline' nowrap=''>nircmd.exe win center alltop</td></tr><tr><td>Remove the title bar of My Computer window.</td><td class='commandline' nowrap=''>nircmd.exe win -style title 'my computer' 0x00C00000</td></tr><tr><td>Return the title bar of My Computer window that we removed in the previous example.</td><td class='commandline' nowrap=''>nircmd.exe win +style title 'my computer' 0x00C00000</td></tr><tr><td>Set the My Computer window to right-to-left order (For hebrew and arabic languages)</td><td class='commandline' nowrap=''>nircmd win +exstyle title 'my computer' 0x00400000</td></tr><tr><td>Set all child windows of  My Computer window to right-to-left order (For hebrew and arabic languages)</td><td class='commandline' nowrap=''>nircmd win child title 'my computer' +exstyle all 0x00400000</td></tr><tr><td>Create a shortcut on your desktop that closes all your Internet Explorer windows </td><td class='commandline'>nircmd.exe cmdshortcut ' '~\$folder.desktop\$ 'Close All IE' win close class 'IEFrame' </td></tr><tr><td>Create a shortcut on your desktop that hides all your Internet Explorer windows </td><td class='commandline'>nircmd.exe cmdshortcut ' '~\$folder.desktop\$ 'Hide All IE' win hide class 'IEFrame' </td></tr><tr><td>Create a shortcut on your desktop that shows back all your Internet Explorer windows </td><td class='commandline'>nircmd.exe cmdshortcut ' '~\$folder.desktop\$ 'Show All IE' win show class 'IEFrame' </td></tr><tr><td>Set the Windows Calculator as top-most window (above all other windows)</td><td class='commandline' nowrap=''>nircmd.exe win settopmost title 'Calculator' 1</td></tr><tr><td>Set the Windows Calculator back to regular window (non top-most window)</td><td class='commandline' nowrap=''>nircmd.exe win settopmost title 'Calculator' 0</td></tr><tr><td>Create a shortcut to Windows calculator under Start Menu-&gt;Programs-&gt;Calculators </td><td class='commandline'>nircmd.exe shortcut 'f:\winnt\system32\calc.exe' '~\$folder.programs\$\Calculators' 'Windows Calculator' </td></tr><tr><td>Hide the desktop window</td><td class='commandline' nowrap=''>nircmd.exe win hide class progman</td></tr><tr><td>Show the desktop window (After hiding it in previous example)</td><td class='commandlin' nowrap=''>nircmd.exe win show class progman</td></tr><tr><td>Hide the start button on the system tray</td><td class='commandline' nowrap=''>nircmd.exe win child class 'Shell_TrayWnd' hide class 'button'</td></tr><tr><td>Show the start button on the system tray</td><td class='commandline' nowrap=''>nircmd.exe win child class 'Shell_TrayWnd' show class 'button'</td></tr><tr><td>Hide the clock on the system tray</td><td class='commandline' nowrap=''>nircmd.exe win child class 'Shell_TrayWnd' hide class 'TrayClockWClass'</td></tr><tr><td>Show the clock on the system tray</td><td class='commandline' nowrap=''>nircmd.exe win child class 'Shell_TrayWnd' show class 'TrayClockWClass' </td></tr><tr><td>Kill (terminate) all instance of Internet Explorer processes</td><td class='commandline' nowrap=''>nircmd.exe killprocess iexplore.exe</td></tr><tr><td>Create a shortcut on your desktop that opens the door of K: CDROM drive when you run it.</td><td class='commandline'>nircmd.exe cmdshortcut '~\$folder.desktop\$' 'Open CDROM' cdrom open k:</td></tr><tr><td>Create a shortcut to NirSoft Web site on your desktop</td><td class='commandline' nowrap=''>nircmd.exe urlshortcut 'http://www.nirsoft.net' '~\$folder.desktop\$' 'NirSoft'</td></tr><tr><td>Add NirSoft Web site to your Favorities under Links folder.</td><td class='commandline'>nircmd.exe urlshortcut 'http://www.nirsoft.net' '~\$folder.favorites\$\Links' 'NirSoft'</td></tr><tr><td>Create a shortcut to NirSoft Web site on the desktop of all computers listed in computers.txt</td><td class='commandline'>nircmd.exe multiremote copy 'c:\temp\computers.txt' urlshortcut 'http://www.nirsoft.net' '~\$folder.common_desktop\$' 'NirSoft'</td></tr><tr><td>Set the display mode to 800x600x24bit colors</td><td class='commandline' nowrap=''>nircmd.exe setdisplay 800 600 24</td></tr><tr><td>Create a shortcut on the desktop that set the display mode to 800x600x24bit colors</td><td class='commandline'>nircmd.exe cmdshortcut '~\$folder.desktop\$' '800x600x24' setdisplay 800 600 24</td></tr><tr><td>Copy all shortcuts on your desktop to another folder (f:\temp\desktop).</td><td class='commandline'>nircmd.exe execmd copy '~\$folder.desktop\$\*.lnk' f:\temp\desktop </td></tr><tr><td>Restart your Apache server (under Windows NT/2000/XP/2003)</td><td class='commandline' nowrap=''>nircmd.exe service restart apache</td></tr><tr><td>Create a shortcut on your desktop that restarts the Apache server</td><td class='commandline'>nircmd.exe cmdshortcut '~\$folder.desktop\$' 'Restart Apache' service restart apache</td></tr><tr><td>Restart your IIS</td><td class='commandline' nowrap=''>nircmd.exe service restart w3svc </td></tr><tr><td>Restart MySql</td><td class='commandline' nowrap=''>nircmd.exe service restart MySql </td></tr><tr><td>Open the desired Registry key/value in RegEdit</td><td class='commandline'>nircmd.exe regedit 'HKLM\Software\Microsoft\Windows\CurrentVersion' 'CommonFilesDir'</td></tr><tr><td>Open the Registry key that you copied to the clipboard in RegEdit.</td><td class='commandline'>nircmd regedit '~\$clipboard\$'</td></tr><tr><td>Disable the screen saver</td><td class='commandline' nowrap=''>nircmd.exe regsetval sz 'HKCU\control panel\desktop' 'ScreenSaveActive' 0</td></tr><tr><td>Enable the screen saver</td><td class='commandline' nowrap=''>nircmd.exe regsetval sz 'HKCU\control panel\desktop' 'ScreenSaveActive' 1</td></tr><tr><td>Change the date/time of the specified filename (creation time and modified time)</td><td class='commandline'>nircmd.exe setfiletime 'c:\temp\myfile.txt' '24-06-2003 17:57:11' '22-11-2005 10:21:56' </td></tr><tr><td>Copy your desktop folder path to the clipboard</td><td class='commandline'>nircmd.exe clipboard set ~\$folder.desktop\$</td></tr><tr><td>Copy your start menu folder path to the clipboard</td><td class='commandline'>nircmd.exe clipboard set ~\$folder.start_menu\$</td></tr><tr><td>Copy the content of info1.txt (simple text file) to the clipboard</td><td class='commandline'>nircmd.exe clipboard readfile 'c:\My Files\info1.txt'</td></tr><tr><td>Add the text content of clipboard to info1.txt</td><td class='commandline'>nircmd.exe clipboard addfile 'c:\My Files\info1.txt'</td></tr><tr><td>Clear the clipboard</td><td class='commandline'>nircmd.exe clipboard clear</td></tr><tr><td>Create all folders specified in 'c:\temp\folders.txt'. The folder path names areseparated by CRLF characters.</td><td class='commandline'>nircmd.exe paramsfile 'c:\temp\folders.txt' '' '' execmd md ~\$fparam.1\$</td></tr><tr><td>Install the specified .NET assembly in the global assembly cache (like gacutil)</td><td class='commandline'>nircmd.exe gac install 'C:\temp\MyAssembly\bin\MyAssembly.dll'</td></tr><tr><td>Empty the recycle bin in all drives.</td><td class='commandline' nowrap=''>nircmd.exe emptybin </td></tr><tr><td>Answer 'Yes' to a standard Windows message-box.</td><td class='commandline' nowrap=''>nircmd.exe dlg '' '' click yes</td></tr><tr><td>Wait 2 seconds, and then save the current screen to shot.png</td><td class='commandline' nowrap=''>nircmd.exe cmdwait 2000 savescreenshot 'f:\temp\shot.png'</td></tr><tr><td>Save 10 screenshots in a loop, and wait 60 seconds between the screenshot save calls.The filenames of the screenshot will contain the time and date of the saved screenshot.</td><td class='commandline'>nircmd.exe loop 10 60000 savescreenshot c:\temp\scr~\$currdate.MM_dd_yyyy\$-~\$currtime.HH_mm_ss\$.png</td></tr><tr><td>Wait until Firefox is closed, and then say 'Firefox was closed'</td><td class='commandline' nowrap=''>waitprocess firefox.exe speak text 'Firefox was closed'</td></tr></tbody></table>");

$arrCmds["new"] =
$arrCmds["webcmd"] = "Opens a new terminal window. \
					 <br /> \
					 <br />NEW \
					 <br />";

$arrCmds["size"] = "Changes the size (in pixels) of the terminal's font. \
					<br /> \
					<br />SIZE [integer] \
					<br /> \
					<br />" . nbsp(2) . "integer" . nbsp(7) . "Number in pixels to which to change. \
					<br />";

?>